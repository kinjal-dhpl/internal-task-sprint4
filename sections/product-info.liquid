{{ 'product-info.css' | asset_url | stylesheet_tag }}

<section class="info-tabs">
  <!-- Tab Buttons -->
  <div class="tab-buttons page-width ">
    <button class="tab-btn active" data-tab="product-info">
      <h2>Product Information</h2>
      <span class="tab-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24">
          <path d="M3 12h18M12 3v18" stroke="#000" stroke-width="2" stroke-linecap="round" />
        </svg>
      </span>
    </button>

    <button class="tab-btn" data-tab="policies">
      <h2>Policies</h2>
      <span class="tab-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24">
          <path d="M3 12h18M12 3v18" stroke="#000" stroke-width="2" stroke-linecap="round" />
        </svg>
      </span>
    </button>
  </div>

  <!-- Tab Content Wrapper -->
  <div class="tab-contents page-width">
    <!-- Product Information Tab -->
    <div class="faq-sec-mobile">
      <button class="tab-btn active tab-btn-mobile" data-tab="product-info">
        <h2>Product Information</h2>
        <span class="tab-icon">
          <svg
            class="toggleIcon"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="none"
            viewBox="0 0 24 24"
          >
            <path class="horizontal" d="M3 12h18" stroke="#000" stroke-width="2" stroke-linecap="round"></path>
            <path class="vertical" d="M12 3v18" stroke="#000" stroke-width="2" stroke-linecap="round"></path>
          </svg>
        </span>
      </button>
      <div id="product-info" class="tab-content active">
        {% if section.settings.top_head != blank %}
          <p class="para-id">{{ section.settings.top_head }}</p>
        {% endif %}
        <div class="product-info-grid">
          <!-- Left Box -->
          {% assign dimensions = product.metafields.custom.dimension_info.value %}

          {% if dimensions != blank %}
            <div class="top-text display-flex-column">
              <h2>Dimensions</h2>
              <div class="info-box flex-grow">
                {% for dimension in dimensions %}
                  <div class="info-item">
                    <h4>
                      {% if dimension.image != blank %}
                        <span style="height: 24px;">
                          {{ dimension.image }}
                        </span>
                      {% endif %}
                      {{ dimension.title }}
                    </h4>
                    {% if dimension.size != blank %}
                      <p>{{ dimension.size }}</p>
                    {% endif %}
                    {% if dimension.description != blank %}
                      <small>{{ dimension.description }}</small>
                    {% endif %}
                  </div>
                {% endfor %}
              </div>
            </div>
          {% endif %}

          <!-- Right Box -->
          {% if section.settings.care_instructions != blank %}
            <div class="top-text display-flex-column">
              <h2>Care Instructions</h2>
              <div class="info-box info-list flex-grow">
                {{ section.settings.care_instructions }}
              </div>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
    <!-- Policies Tab -->
    <div class="faq-sec-mobile">
      <button class="tab-btn tab-btn-mobile" data-tab="policies">
        <h2>Policies</h2>
        <span class="tab-icon">
          <svg
            class="toggleIcon"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="none"
            viewBox="0 0 24 24"
          >
            <path class="horizontal" d="M3 12h18" stroke="#000" stroke-width="2" stroke-linecap="round"></path>
            <path class="vertical" d="M12 3v18" stroke="#000" stroke-width="2" stroke-linecap="round"></path>
          </svg>
        </span>
      </button>
      <div id="policies" class="tab-content">
        <div class="section-header">
          <p>Simple, transparent policies designed to give you complete confidence in your purchase</p>
        </div>

        {% assign policies = product.metafields.custom.policymeta.value %}

        {% if policies != blank %}
          <div class="policies-container">
            {% for policy in policies %}
              {% if policy.image != blank
                or policy.container_top_text != blank
                or policy.container_desc != blank
                or policy.container_bottom_text != blank
              %}
                <div class="policy-card">
                  <div class="policy-icon">
                    {% if policy.image != blank %}
                      {{ policy.image }}
                      <!-- if your icon is stored as SVG in a metaobject rich text -->
                    {% endif %}
                    {% if policy.container_top_text != blank %}
                      <h3>{{ policy.container_top_text }}</h3>
                    {% endif %}
                  </div>

                  {% if policy.container_desc != blank %}
                    <p class="id-unique">{{ policy.container_desc }}</p>
                  {% endif %}
                  {% if policy.container_bottom_text != blank %}
                    <p>{{ policy.container_bottom_text }}</p>
                  {% endif %}
                </div>
              {% endif %}
            {% endfor %}
          </div>
        {% endif %}

        {% if section.settings.important_info != blank %}
          <div class="important-info">
            <h2>Important information</h2>
            <div class="info-list">
              <ul>
                <li>
                  {{ section.settings.important_info }}
                </li>
              </ul>
            </div>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const buttons = document.querySelectorAll('.info-tabs .tab-btn');
    const tabs = document.querySelectorAll('.info-tabs .tab-content');

    buttons.forEach((btn) => {
      btn.addEventListener('click', () => {
        const targetId = btn.getAttribute('data-tab');
        const targetTab = document.getElementById(targetId);
        if (!targetTab) {
          return;
        }
        if (window.innerWidth <= 768) {
          // Mobile behavior: toggle open/close like FAQ
          const isOpen = btn.classList.contains('active');
          buttons.forEach((b) => b.classList.remove('active'));
          tabs.forEach((tab) => tab.classList.remove('active'));
          if (!isOpen) {
            btn.classList.add('active');
            targetTab.classList.add('active');
          }
        } else {
          buttons.forEach((b) => b.classList.remove('active'));
          tabs.forEach((tab) => tab.classList.remove('active'));
          btn.classList.add('active');
          targetTab.classList.add('active');
        }

        if (window.innerWidth <= 768) {
          buttons.forEach((button) => {
            const verticalLine = button.querySelector('.vertical');
            if (!verticalLine) return;
            verticalLine.classList.toggle('hidden', !button.classList.contains('active'));
          });
        }
      });
    });

    const syncMobileIcons = () => {
      if (window.innerWidth > 768) {
        buttons.forEach((button) => {
          const verticalLine = button.querySelector('.vertical');
          if (verticalLine) {
            verticalLine.classList.remove('hidden');
          }
        });
      }
    };

    window.addEventListener('resize', syncMobileIcons);
    syncMobileIcons();
  });
</script>

{% schema %}
{
  "name": "product_section",
  "settings": [
    {
      "type": "text",
      "id": "top_head",
      "label": "Heading"
    },
    {
      "type": "richtext",
      "id": "care_instructions",
      "label": "Care Instructions"
    },
    {
      "type": "richtext",
      "id": "important_info",
      "label": "Important Information"
    }
  ],
  "presets": [
    {
      "name": "product_section"
    }
  ]
}
{% endschema %}